<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>GT Database Cloud</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div id="loading-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999; transition: opacity 0.5s ease;">
    <div class="loader" style="width: 50px; height: 50px; border: 5px solid #333; border-top: 5px solid #e10600; border-radius: 50%; animation: spin 1s linear infinite;"></div>
    <p style="color: white; margin-top: 20px; font-family: sans-serif; letter-spacing: 2px; text-transform: uppercase; font-size: 0.8rem;">Caricamento Garage...</p>
</div>

<style>
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
</style>

<header>
    <div class="header-top">
    <h1>Gran Turismo Database</h1>
    <div class="version-wrapper">
        <span class="badge-alpha">PRE-ALPHA</span>
        <span class="info-icon-version" onclick="apriChangelog()">i</span>
    </div>
</div>

<div id="changelogModal" class="modal">
    <div class="modal-content">
        <span class="close-changelog" onclick="chiudiChangelog()">&times;</span>
        <div id="changelog-body">
            </div>
    </div>
</div>

    <div id="auth-status">
        <button id="login-btn" class="game-btn">Accedi con Google</button>
        <div class="pdf-dropdown">
            <button id="pdf-main-btn" class="game-btn">Scarica Lista PDF ▼</button>
            <div id="pdf-options" class="dropdown-content">
                <a href="javascript:void(0)" onclick="scaricaPDF('gt7')">Gran Turismo 7</a>
                <a href="javascript:void(0)" onclick="scaricaPDF('mfgt')">My First Gran Turismo</a>
                <div class="dropdown-divider"></div>
                <a href="javascript:void(0)" onclick="scaricaPDF('entrambi')">Lista completa</a>
            </div>
        </div>
    </div>

    <div class="search-container">
        <input type="text" id="searchBar" placeholder="Cerca un'auto o una marca...">
    </div>
    
    <div id="game-selector">
        <button class="game-btn active" data-game="gt7">Gran Turismo 7</button>
        <button class="game-btn" data-game="mfgt">My First Gran Turismo</button>
    </div>

    <div id="garage-filter-selector">
        <button class="sort-btn active" onclick="setFiltroGarage('all', this)">Tutte</button>
        <button class="sort-btn" onclick="setFiltroGarage('possedute', this)">Nel garage</button>
        <button class="sort-btn" onclick="setFiltroGarage('mancanti', this)">Non nel garage</button>
    </div>

    <div id="filter-container">
        <select id="filter-country">
            <option value="all">Tutti i Paesi</option>
        </select>
        <select id="filter-brand">
            <option value="all">Tutte le Marche</option>
        </select>
        <button id="reset-filters">Ripristina</button>
    </div>

    <div id="stats-panel">
        <div id="game-stats">
            <span id="game-name-label"></span>
            <span id="owned-count">0</span> / <span id="total-count">0</span> 
            (<span id="completion-perc">0%</span>)
        </div>
        <div class="progress-container">
            <div id="progress-bar"></div>
        </div>
    </div>

    <div id="sort-container">
    <button class="sort-btn active" data-sort="default">Default</button>
    <button class="sort-btn" data-sort="marca">Per costruttore</button>
    <button class="sort-btn" data-sort="paese">Per Paese/regione</button>
    <button class="sort-btn" data-sort="anno">Per Anno</button>
    <button class="sort-btn" data-sort="aspirazione">Per Aspirazione</button>
    <button class="sort-btn" data-sort="trasmissione">Per trasmissione</button>
    <button class="sort-btn" data-sort="potenza">Per potenza</button>
    <button class="sort-btn" data-sort="peso">Per peso</button>

<button class="sort-btn special-btn nascondi-tasto" id="btn-tutte-le-auto">Tutte le Auto</button>
<button class="sort-btn special-btn" id="btn-altre-auto">Altre Auto</button>
</div>
</header>

<main>
    </main>

<div id="carModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <div id="modal-body"></div>
    </div>
</div>

<div id="brandModal" class="modal">
    <div class="modal-content brand-modal-content">
        <span class="close-brand-button">&times;</span>
        <div id="brand-modal-body">
            </div>
    </div>
</div>

<div id="legenda-container">
    <button id="legenda-toggle">Legenda Abbreviazioni ▾</button>
    <div id="legenda-content">
        <div class="legenda-section">
            <h4>Trasmissione</h4>
            <ul>
                <li><strong>FF:</strong> Motore Ant. Trazione Ant.</li>
                <li><strong>FR:</strong> Motore Ant. Trazione Post.</li>
                <li><strong>MR:</strong> Motore Centr. Trazione Post.</li>
                <li><strong>RR:</strong> Motore Post. Trazione Post.</li>
                <li><strong>4WD:</strong> Trazione Integrale</li>
            </ul>
        </div>
        <div class="legenda-section" id="legenda-aspirazione">
            <h4>Aspirazione</h4>
            <ul>
                <li><strong>AN:</strong> Aspirazione Naturale</li>
                <li><strong>TC:</strong> Turbocompressore</li>
                <li><strong>CV:</strong> Compressore Volumetrico</li>
                <li><strong>TC+CV:</strong> Turbo + Compressore</li>
                <li><strong>VE:</strong> Veicolo elettrico</li>
            </ul>
        </div>
        <div class="legenda-section">
            <h4>Tipo di motore</h4>
            <ul>
                <li><strong>I:</strong> Cilindri in linea</li>
                <li><strong>B:</strong> Cilindri piatti (Boxer)</li>
                <li><strong>V:</strong> Cilindri a V</li>
                <li><strong>VR:</strong> Cilindri a VR</li>
                <li><strong>W:</strong> Cilindri a W</li>
            </ul>
        </div>
    </div>
</div>

<footer>
    <p>&copy; 2026 Progetto Fan Gran Turismo</p>
</footer>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCcdcsIWEZ1j6Vq0_ImyNRxna2bJyVYWL0",
        authDomain: "gt-database-fedcd.firebaseapp.com",
        projectId: "gt-database-fedcd",
        storageBucket: "gt-database-fedcd.firebasestorage.app",
        messagingSenderId: "542867018660",
        appId: "1:542867018660:web:dacf4c5243e37259d32731"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    const provider = new firebase.auth.GoogleAuthProvider();
</script>
<script src="script.js?v=18"></script>
<div id="lightbox" onclick="closeLightbox()" style="display: none; position: fixed; z-index: 99999; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); justify-content: center; align-items: center; cursor: zoom-out;">
    <img id="lightbox-img" style="max-width: 95%; max-height: 90%; border-radius: 4px; box-shadow: 0 0 30px rgba(255,255,255,0.1); transition: transform 0.1s ease-out;">
</div>
</body>
</html>